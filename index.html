<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Custom Typing Practice</title>
  <style>
    :root {
      --bg: #0b1020;
      --panel: #121933;
      --panel-2: #0f1530;
      --text: #e6ecff;
      --muted: #9eb0ff99;
      --accent: #7aa2ff;
      --good: #6ee7a8;
      --bad: #ff6b6b;
      --ring: 0 0 0 3px rgba(122, 162, 255, .25);
    }

    body {
      margin: 0;
      font: 16px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }

    .container {
      width: 100%;
      max-width: 900px;
      padding: 16px;
      display: flex;
      flex-direction: column;
      align-items: center
    }

    /* --- Header Bar --- */
    .header-bar {
      width: 100%;
      background: var(--panel);
      border-bottom: 1px solid #1e2755;
      padding: 12px 20px;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .header-bar h1 {
      margin: 0px 20px;
      font-size: 20px;
      font-weight: 700;
      color: var(--text);
    }

    .header-bar a {
      text-decoration: none;
    }

    .header-btn {
      background: var(--bad);
      color: var(--text);
      padding: 8px 14px;
      margin: 8px 14px;
      border-radius: 8px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      font-size: 14px;
    }

    .header-btn:hover {
      background: var(--good);
      color: var(--bg);
      transform: translateY(-2px);
      /* subtle lift */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
    }

    .top-img img {
      width: 650px;
      max-height: 550px;
      object-fit: fill;
      border-radius: 12px;
      border: 2px solid #1e2755;
      margin-bottom: 20px
    }

    .card {
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      border: 1px solid #1e2755;
      border-radius: 18px;
      padding: 16px;
      margin-bottom: 20px;
      width: 100%
    }

    .prompt {
      font-size: 22px;
      line-height: 1.6;
      letter-spacing: .2px;
      user-select: none;
      padding: 14px;
      border-radius: 14px;
      border: 1px dashed #2a3468;
      background: #0d1430;
      min-height: 60px
    }

    .char {
      opacity: .55
    }

    .char.done {
      opacity: 1;
      color: #dfe6ff
    }

    .char.good {
      color: var(--good)
    }

    .char.bad {
      color: var(--bad)
    }

    /* .cursor::after{content:"";position:absolute;left:0;bottom:-3px;width:100%;height:2px;background:var(--accent)} */

    .input-wrap {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-top: 14px
    }

    #input,
    #customPhrase {
      flex: 1;
      border: none;
      outline: none;
      background: #0d1430;
      border: 1px solid #2a3468;
      color: var(--text);
      border-radius: 12px;
      padding: 14px 12px;
      font-size: 18px
    }

    #input:focus,
    #customPhrase:focus {
      box-shadow: var(--ring)
    }

    .btn {
      cursor: pointer;
      border: 1px solid #2a3468;
      background: #111739;
      color: #e8edff;
      padding: 10px 14px;
      border-radius: 12px;
      font-weight: 600
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
      margin-top: 16px
    }

    .stat {
      padding: 14px;
      border-radius: 12px;
      background: #0d1430;
      border: 1px solid #1e2755;
      text-align: center
    }

    .stat .label {
      font-size: 12px;
      color: var(--muted)
    }

    .stat .value {
      font-size: 22px;
      font-weight: 700;
      margin-top: 4px
    }

    .footer {
      margin-top: 22px;
      font-size: 12px;
      color: #95a1ff9c;
      text-align: center
    }

    #summary {
      margin-top: 20px;
      padding: 16px;
      background: #0d1430;
      border: 1px solid #1e2755;
      border-radius: 12px;
      display: none
    }
  </style>
</head>

<body>

  <!-- Header Bar -->
  <div class="header-bar">
    <h1>Custom Typing Practice</h1>
    <a href="./index.html">
      <button class="header-btn">Home</button>
    </a>

    <a href="./Touch.html" target="_blank">
      <button class="header-btn">Touch typing</button>
    </a>

    <a href="https://zty.pe/" target="_blank">
      <button class="header-btn">Ztype</button>
    </a>

    <a href="https://www.typing.com/student/tests" target="_blank">
      <button class="header-btn">Typing Test</button>
    </a>
  </div>

  <div class="container">
    <div class="top-img">
      <img src="./TouchTypingKeyboardFingerChart.jpg" />
    </div>

    <section class="card">
      <div>
        <input id="customPhrase" type="text" placeholder="Enter your phrase here…" />
        <button id="setPhraseBtn" class="btn">Set Phrase</button>
      </div>
      <div id="prompt" class="prompt"></div>
      <div class="input-wrap">
        <input id="input" type="text" autocomplete="off" spellcheck="false" placeholder="Start typing here…" />
        <button id="resetBtn" class="btn">Restart</button>
        <button id="finishBtn" class="btn">Finish</button>
      </div>

      <div class="stats">
        <div class="stat">
          <div class="label">Time</div>
          <div id="time" class="value">0.0s</div>
        </div>
        <div class="stat">
          <div class="label">WPM</div>
          <div id="wpm" class="value">0</div>
        </div>
        <div class="stat">
          <div class="label">Accuracy</div>
          <div id="acc" class="value">100%</< /div>
          </div>
          <div class="stat">
            <div class="label">Errors</div>
            <div id="err" class="value">0</div>
          </div>
          <div class="stat">
            <div class="label">Completed</div>
            <div id="completed" class="value">0</div>
          </div>
        </div>
    </section>

    <div id="summary"></div>
    <div class="footer">
      Infinite practice with your own phrases. <br>
      Credit to <a target="_blank" href="https://www.linkedin.com/in/sameer-bhatti-8a2256235/"
        style="text-decoration: none;">Sameer Bhatti</a>
    </div>
  </div>

  <script>
    (function () {
      let TARGET = "the quick brown fox jumps over the lazy dog";
      const promptEl = document.getElementById('prompt');
      const inputEl = document.getElementById('input');
      const resetBtn = document.getElementById('resetBtn');
      const setPhraseBtn = document.getElementById('setPhraseBtn');
      const customPhraseEl = document.getElementById('customPhrase');
      const finishBtn = document.getElementById('finishBtn');
      const timeEl = document.getElementById('time');
      const wpmEl = document.getElementById('wpm');
      const accEl = document.getElementById('acc');
      const errEl = document.getElementById('err');
      const completedEl = document.getElementById('completed');
      const summaryEl = document.getElementById('summary');

      let started = false, startTs = 0, timerId = null;
      let typedCount = 0, errorCount = 0, correctCount = 0;
      let completedCount = 0;
      let history = [];

      function renderPrompt(index = 0, errorsAt = []) {
        promptEl.innerHTML = '';
        for (let i = 0; i < TARGET.length; i++) {
          const span = document.createElement('span');
          span.textContent = TARGET[i];
          span.className = 'char';
          if (i < index) {
            if (errorsAt[i]) span.classList.add('bad'); else span.classList.add('good');
          }
          if (i === index) {
            span.classList.add('cursor');
          }
          promptEl.appendChild(span);
        }
      }

      function reset() {
        started = false; startTs = 0; if (timerId) cancelAnimationFrame(timerId);
        typedCount = 0; errorCount = 0; correctCount = 0;
        inputEl.value = '';
        renderPrompt(0, []);
        updateStats(0);
        inputEl.focus();
      }

      function startTimer() {
        if (started) return; started = true; startTs = performance.now();
        const tick = () => {
          if (!started) return; updateStats(); timerId = requestAnimationFrame(tick);
        }; tick();
      }

      function updateStats(now) {
        const t = (now ? now : performance.now()) - (startTs || performance.now());
        const secs = started ? t / 1000 : 0;
        const mins = secs / 60;
        const grossWpm = mins > 0 ? (typedCount / 5) / mins : 0;
        const netWpm = Math.max(0, grossWpm - (errorCount / mins || 0));
        const acc = typedCount > 0 ? (correctCount / typedCount) * 100 : 100;

        timeEl.textContent = (secs).toFixed(1) + "s";
        wpmEl.textContent = Math.round(netWpm);
        accEl.textContent = Math.max(0, Math.min(100, acc)).toFixed(0) + "%";
        errEl.textContent = errorCount;
      }

      function recordRun() {
        const time = timeEl.textContent;
        const wpm = wpmEl.textContent;
        const acc = accEl.textContent;
        const err = errEl.textContent;
        history.push({ time, wpm, acc, err });
      }

      inputEl.addEventListener('keydown', (e) => {
        if (!started && (e.key.length === 1 || e.key === 'Backspace' || e.key === ' ')) startTimer();
      });

      inputEl.addEventListener('input', () => {
        const v = inputEl.value;
        const idx = Math.min(v.length, TARGET.length);
        typedCount = v.length;

        const errorsAt = [];
        correctCount = 0; errorCount = 0;
        for (let i = 0; i < idx; i++) {
          const good = v[i] === TARGET[i];
          if (good) correctCount++; else { errorCount++; errorsAt[i] = true; }
        }
        renderPrompt(idx, errorsAt);
        updateStats();

        if (idx === TARGET.length) {
          recordRun();
          completedCount++;
          completedEl.textContent = completedCount;
          reset();
        }
      });

      resetBtn.addEventListener('click', reset);
      setPhraseBtn.addEventListener('click', () => {
        if (customPhraseEl.value.trim() !== "") {
          TARGET = customPhraseEl.value.trim();
          reset();
        }
      });
      finishBtn.addEventListener('click', () => {
        let html = `<h2>Summary</h2><ul>`;
        history.forEach((h, i) => {
          html += `<li>Run ${i + 1}: Time ${h.time}, WPM ${h.wpm}, Accuracy ${h.acc}, Errors ${h.err}</li>`;
        });
        html += `</ul>`;
        summaryEl.innerHTML = html;
        summaryEl.style.display = 'block';
      });

      renderPrompt(0, []);
    })();
  </script>
</body>

</html>